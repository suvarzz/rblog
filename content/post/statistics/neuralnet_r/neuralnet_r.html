---
title: "Neuralnet R"
author: "Mark Goldberg"
date: '2019-08-06'
draft: false
math: true
tags: ["R", "Statistics", "Classification", "Neural Network"]
categories: ["Statistics"]
#bibliography: [bib.bib]
output:
  #blogdown::html_page:
  toc: true
summary: "Examples of Neural Network classification using Neuralnet R package."
---



<p>Using of <code>neuralnet</code> R package to tran Neural Network for classification.</p>
<pre class="r"><code>library(neuralnet)
library(datasets)

# data
df &lt;- datasets::iris
head(df)</code></pre>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<pre class="r"><code># split data
train.ratio = 0.9
n = nrow(df)

train.id &lt;- sample(n, size = n*train.ratio)
train &lt;- df[train.id,]
test &lt;- df[-train.id,]</code></pre>
<div id="binary-classification" class="section level2">
<h2>Binary classification</h2>
<pre class="r"><code>nn &lt;- neuralnet(Species == &quot;setosa&quot; ~ Petal.Length + Petal.Width, train, linear.output = FALSE)

# Predict for test data
pred &lt;- predict(nn, test)
# Confusion matrix
t &lt;- table(test$Species == &quot;setosa&quot;, pred[, 1] &gt; 0.5)
t</code></pre>
<pre><code>##        
##         FALSE TRUE
##   FALSE     8    0
##   TRUE      0    7</code></pre>
<pre class="r"><code># plot NN
plot(nn)

# Confusion matrix using caret
library(caret)</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre class="r"><code>caret::confusionMatrix(t)</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##        
##         FALSE TRUE
##   FALSE     8    0
##   TRUE      0    7
##                                     
##                Accuracy : 1         
##                  95% CI : (0.782, 1)
##     No Information Rate : 0.5333    
##     P-Value [Acc &gt; NIR] : 8.035e-05 
##                                     
##                   Kappa : 1         
##                                     
##  Mcnemar&#39;s Test P-Value : NA        
##                                     
##             Sensitivity : 1.0000    
##             Specificity : 1.0000    
##          Pos Pred Value : 1.0000    
##          Neg Pred Value : 1.0000    
##              Prevalence : 0.5333    
##          Detection Rate : 0.5333    
##    Detection Prevalence : 0.5333    
##       Balanced Accuracy : 1.0000    
##                                     
##        &#39;Positive&#39; Class : FALSE     
## </code></pre>
</div>
<div id="multiclass-classification" class="section level2">
<h2>Multiclass classification</h2>
<pre class="r"><code>nn &lt;- neuralnet((Species == &quot;setosa&quot;) + (Species == &quot;versicolor&quot;) + (Species == &quot;virginica&quot;) 
                ~ Petal.Length + Petal.Width, train, linear.output = FALSE)

# Predict for test data
pred &lt;- predict(nn, test)
table(test$Species, apply(pred, 1, which.max))</code></pre>
<pre><code>##             
##              2 3
##   setosa     6 1
##   versicolor 4 0
##   virginica  4 0</code></pre>
<pre class="r"><code># Plot NN
plot(nn)

# Confusion matrix using &#39;caret&#39;
caret::confusionMatrix(t)</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##        
##         FALSE TRUE
##   FALSE     8    0
##   TRUE      0    7
##                                     
##                Accuracy : 1         
##                  95% CI : (0.782, 1)
##     No Information Rate : 0.5333    
##     P-Value [Acc &gt; NIR] : 8.035e-05 
##                                     
##                   Kappa : 1         
##                                     
##  Mcnemar&#39;s Test P-Value : NA        
##                                     
##             Sensitivity : 1.0000    
##             Specificity : 1.0000    
##          Pos Pred Value : 1.0000    
##          Neg Pred Value : 1.0000    
##              Prevalence : 0.5333    
##          Detection Rate : 0.5333    
##    Detection Prevalence : 0.5333    
##       Balanced Accuracy : 1.0000    
##                                     
##        &#39;Positive&#39; Class : FALSE     
## </code></pre>
</div>
<div id="bibliography" class="section level2">
<h2>Bibliography</h2>
</div>
